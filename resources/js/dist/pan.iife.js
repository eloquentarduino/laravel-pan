(function(){"use strict";window.__pan=window.__pan||{csrfToken:"%_PAN_CSRF_TOKEN_%",routePrefix:"%_PAN_ROUTE_PREFIX_%",observer:null,clickListener:null,mouseoverListener:null,inertiaStartListener:null,intersectionObserver:null},window.__pan.observer&&(window.__pan.observer.disconnect(),window.__pan.observer=null),window.__pan.clickListener&&(document.removeEventListener("click",window.__pan.clickListener),window.__pan.clickListener=null),window.__pan.mouseoverListener&&(document.removeEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.mouseoverListener=null),window.__pan.inertiaStartListener&&(document.removeEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.inertiaStartListener=null),function(){const v=e=>{const n=new MutationObserver(e);n.observe(document.body,{childList:!0,subtree:!0,attributes:!0}),window.__pan.observer=n},f=e=>{window.__pan.intersectionObserver=new IntersectionObserver(e)};let r=[],a=null,o=[],c=[],u=[],l=[];const d=()=>{if(r.length===0)return;const e=r.slice();r=[],navigator.sendBeacon(`/${window.__pan.routePrefix}/events`,new Blob([JSON.stringify({events:e,_token:window.__pan.csrfToken})],{type:"application/json"}))},_=function(){a&&clearTimeout(a),a=setTimeout(d,1e3)},w=function(e,n){const i=e.target.closest("[data-pan]");if(i===null)return;const s=i.getAttribute("data-pan");if(s!==null){if(n==="hover"){if(c.includes(s))return;c.push(s)}if(n==="click"){if(u.includes(s))return;u.push(s)}r.push({type:n,name:s}),_()}},p=function(){document.querySelectorAll("[data-pan]").forEach(n=>{if(n.checkVisibility!==void 0&&!n.checkVisibility())return;const t=n.getAttribute("data-pan");t!==null&&(o.includes(t)||(o.push(t),r.push({type:"impression",name:t})))}),_()};v(function(){o.forEach(e=>{var t;const n=document.querySelector(`[data-pan='${e}']`);n===null?(o=o.filter(i=>i!==e),c=c.filter(i=>i!==e),u=u.filter(i=>i!==e)):(t=window.__pan.intersectionObserver)==null||t.observe(n)}),p()}),f(function(e){e.forEach(n=>{const t=n.target.getAttribute("data-pan");!t||!n.isIntersecting||l.includes(t)||(l.push(t),r.push({type:"visible",name:t}))})}),window.__pan.clickListener=e=>w(e,"click"),document.addEventListener("click",window.__pan.clickListener),window.__pan.mouseoverListener=e=>w(e,"hover"),document.addEventListener("mouseover",window.__pan.mouseoverListener),window.__pan.inertiaStartListener=e=>{o=[],c=[],u=[],p()},document.addEventListener("inertia:start",window.__pan.inertiaStartListener),window.__pan.beforeUnloadListener=function(e){r.length!==0&&d()},window.addEventListener("beforeunload",window.__pan.beforeUnloadListener)}()})();
